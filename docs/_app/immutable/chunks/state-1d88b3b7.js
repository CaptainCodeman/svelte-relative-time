const p=new Map;function b(t){if(p.has(t))return p.get(t);const e=new Intl.RelativeTimeFormat(t,{numeric:"auto"});return p.set(t,e),e}function h(t,e){const{date:o,callback:m,formatter:l}=t,n=(typeof o=="number"?o:o.getTime())-e,u=n/1e3,a=[60,3600,86400,86400*7,86400*30,86400*365,1/0],r=["second","minute","hour","day","week","month","year"],f=a.findIndex(w=>w>Math.abs(u)),I=f?a[f-1]:1,v=Math.round(u/I);m(l.format(v,r[f]));const i=I*1e3;let c;return f?(c=i/2-Math.abs(n)%i,c<0&&(c+=i)):c=i-Math.abs(n)%i,e+c}const s=new Map;let d;function y(t,e,o,m,l){const M=b(o),n={date:e,callback:l,formatter:M},u=h(n,Date.now());m?s.set(t,{...n,update:u}):s.delete(t),s.size&&(d=d||setInterval(()=>{const a=Date.now();for(const r of s.values())r.update<=a&&(r.update=h(r,a))},1e3))}function x(t){s.delete(t),s.size===0&&(clearInterval(d),d=0)}export{y as r,x as u};
